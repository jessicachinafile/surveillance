<html>
  <head>
    <title>Leaflet.timeline Example - Country Borders</title>
    <link rel="stylesheet" href="leaflet.css" />
    <script src="leaflet.js"></script>
    <script src="leaflet.timeline.js"></script>

    <style>
      html, body{
        margin: 0;
        padding: 0;
      }
      #map{
        width: 100vw;
        height: 100vh;
      }
      .leaflet-bottom.leaflet-left{
        width: 100%;
      }
      .leaflet-control-container .leaflet-timeline-controls{
        box-sizing: border-box;
        width: 100%;
        margin: 0;
        margin-bottom: 15px;
      }

			/* all this fade-in fade-out business is from here: https://stackoverflow.com/a/27029716/7841877
			... and some more styling here: https://www.w3schools.com/css/css3_animations.asp */
			.leaflet-marker-icon,
			.leaflet-marker-shadow {
				fill: red;
			  -webkit-animation: fadein 3s; /* Safari, Chrome and Opera > 12.1 */
			  -moz-animation: fadein 3s; /* Firefox < 16 */
			  -ms-animation: fadein 3s; /* Internet Explorer */
			  -o-animation: fadein 3s; /* Opera < 12.1 */
			  animation: fadein 3s;
				animation-fill-mode: both;
			}


			@keyframes fadein {
					0%   {opacity: 0; }
					5%	 {opacity: .2; }
					10%	 {opacity: .4; }
					15%	 {opacity: .6; }
				  20%	 {opacity: .8; }
					25%  {opacity: 1;}
					50%  {opacity: .9;}
					75%  {opacity: .8;}
					100% {opacity: .7;}
			}
			/* Firefox < 16 */
			@-moz-keyframes fadein {
				0%   {opacity: 0; }
				5%	 {opacity: .2; }
				10%	 {opacity: .4; }
				15%	 {opacity: .6; }
				20%	 {opacity: .8; }
				25%  {opacity: 1;}
				50%  {opacity: .9;}
				75%  {opacity: .8;}
				100% {opacity: .7;}
			}
			/* Safari, Chrome and Opera > 12.1 */
			@-webkit-keyframes fadein {
				0%   {opacity: 0; }
				5%	 {opacity: .2; }
				10%	 {opacity: .4; }
				15%	 {opacity: .6; }
				20%	 {opacity: .8; }
				25%  {opacity: 1;}
				50%  {opacity: .9;}
				75%  {opacity: .8;}
				100% {opacity: .7;}
			}
			/* Internet Explorer */
			@-ms-keyframes fadein {
				0%   {opacity: 0; }
				5%	 {opacity: .2; }
				10%	 {opacity: .4; }
				15%	 {opacity: .6; }
				20%	 {opacity: .8; }
				25%  {opacity: 1;}
				50%  {opacity: .9;}
				75%  {opacity: .8;}
				100% {opacity: .7;}
			}
			/* Opera < 12.1 */
			@-o-keyframes fadein {
				0%   {opacity: 0; }
				5%	 {opacity: .2; }
				10%	 {opacity: .4; }
				15%	 {opacity: .6; }
				20%	 {opacity: .8; }
				25%  {opacity: 1;}
				50%  {opacity: .9;}
				75%  {opacity: .8;}
				100% {opacity: .7;}
			}

    </style>
  </head>
  <body>
    <div id="map"></div>

    <script>
		//generated by slowly changing the examples here (borders as the basic template, earthquakes to figure out how to put in point markers rather than polygons): https://github.com/skeate/Leaflet.timeline
		// also got some good info here: https://maptimeboston.github.io/leaflet-intro/

		//base layer source: http://leaflet-extras.github.io/leaflet-providers/preview/
      var osmUrl = 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}{r}.png';
      var osmAttrib = 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';

      var osm = L.tileLayer(osmUrl, {maxZoom: 20, attribution: osmAttrib});
      var map = L.map('map', {layers: [osm], center: new L.LatLng(22.919886, 112.968290), zoom: 13 });
      var timeline;
      var timelineControl;

			//NEED TO MAKE SURE WE DO ICON ATTRIBUTION WHEN WE'RE DONE Surveillance Camera by Mister Pixel from the Noun Project
			var cameraIcon = L.icon({
			    iconUrl: 'red_camera.png',
			    iconSize: [38,34]
			  });

      function onLoadData(data){
        timeline = L.timeline(data, {
          pointToLayer: function(data, latlng){
		            return L.marker(latlng, {
		              icon: cameraIcon
		            })
          },
          waitToUpdateMap: true,
          onEachFeature: function(feature, layer) {
            layer.bindTooltip(feature.properties.camera_info);
          }
        });

        timelineControl = L.timelineSliderControl({
          formatOutput: function(date) {
            return new Date(date).toLocaleDateString();
          },
          enableKeyboardControls: true,
        });
        timeline.addTo(map);
        timelineControl.addTo(map);
        timelineControl.addTimelines(timeline);
      }
    </script>
    <script src="test_xiqiao.geojson"></script>
  </body>
</html>
